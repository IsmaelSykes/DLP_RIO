import numpy as np
import matplotlib.pyplot as plt
from numpy.fft import fft, ifft
import math

plt.style.use('seaborn-poster')

fa = 60
fs = 8e3
T = 1/fa
Ts = 1/fs
time = np.linspace(0,4*T,512)
full_scale_Resample = 18196
burden = 164
nomial_voltage= 127
nominal_current=3
PGA_GAIN_CURRENT = 1 # gain 1
R1 = 991

va= np.array([
-1869,-1869,-1869,-1998,-2122,-2240,-2355,-2464,-2564,-2661,-2751,-2834,-2912,-2979,-3041,-3097,-3143,-3184,-3216,-3240,-3257,-3264,-3266,-3259,-3243,-3221,-3190,-3152,-3105,-3050,-2991,-2923,-2848,-2767,-2678,-2584,-2483,-2376,-2264,-2145,-2021,-1893,-1760,-1624,-1482,-1339,-1189,-1036,-885,-729,-572,-414,-253,-93,66,225,383,543,701,856,1010,1161,1309,1456,1599,1737,1870,1999,2123,2241,2357,2465,2567,2665,2755,2838,2914,2983,3045,3100,3146,3186,3217,3239,3247,3251,3257,3257,3254,3241,3204,3152,3112,3061,2990,2930,2852,2765,2683,2582,2483,2378,2262,2147,2023,1894,1761,1623,1481,1337,1189,1039,887,731,573,415,256,96,-65,-224,-384,-543,-699,-855,-1009,-1160,-1309,-1454,-1596,-1734,-1867,-1998,-2121,-2240,-2354,-2462,-2564,-2661,-2751,-2834,-2911,-2980,-3042,-3096,-3144,-3183,-3215,-3241,-3256,-3264,-3266,-3259,-3244,-3220,-3189,-3152,-3105,-3050,-2992,-2923,-2848,-2767,-2679,-2584,-2483,-2377,-2264,-2146,-2021,-1892,-1761,-1623,-1483,-1338,-1188,-1038,-883,-729,-572,-413,-254,-93,67,226,385,543,702,857,1011,1163,1310,1457,1600,1738,1871,2000,2123,2242,2357,2465,2569,2666,2755,2839,2914,2983,3046,3100,3147,3186,3218,3239,3247,3251,3257,3257,3254,3241,3204,3152,3111,3062,2989,2929,2852,2764,2683,2582,2481,2378,2261,2145,2022,1892,1760,1621,1479,1335,1188,1037,884,728,572,413,253,95,-67,-227,-385,-546,-701,-856,-1012,-1162,-1311,-1456,-1597,-1737,-1869,-1998,-2123,-2242,-2356,-2464,-2565,-2662,-2753,-2835,-2912,-2981,-3042,-3098,-3144,-3184,-3216,-3239,-3257,-3265,-3266,-3259,-3243,-3221,-3189,-3151,-3104,-3050,-2991,-2922,-2848,-2767,-2677,-2583,-2483,-2375,-2262,-2145,-2020,-1891,-1759,-1622,-1481,-1337,-1186,-1035,-883,-727,-571,-412,-252,-92,69,227,385,546,702,858,1013,1163,1311,1458,1600,1738,1873,2000,2124,2244,2357,2466,2569,2666,2756,2839,2915,2984,3045,3100,3147,3187,3218,3238,3247,3251,3257,3258,3254,3241,3204,3152,3111,3061,2989,2929,2851,2764,2682,2581,2482,2376,2261,2147,2021,1893,1760,1620,1480,1335,1187,1038,885,728,572,413,253,95,-66,-226,-385,-544,-701,-857,-1010,-1163,-1310,-1455,-1598,-1734,-1869,-1998,-2122,-2240,-2355,-2464,-2564,-2662,-2752,-2834,-2912,-2981,-3041,-3098,-3144,-3183,-3216,-3240,-3256,-3266,-3266,-3258,-3244,-3220,-3189,-3151,-3104,-3051,-2991,-2922,-2848,-2767,-2678,-2584,-2483,-2376,-2264,-2145,-2022,-1893,-1761,-1623,-1482,-1339,-1189,-1036,-884,-729,-571,-414,-254,-93,66,225,384,543,701,856,1011,1162,1309,1457,1599,1736,1872,1999,2123,2242,2356,2465,2567,2665,2756,2837,2914,2983,3044,3100,3147,3186,3218,3239,3246,3252,3257,3257,3254,3241,3205,3152,3112,3062,2990,2930,2852,2765,2684,2582,2483,2378,2262,2148,2023,1893,1762,1623,1481,1337,1189,1040,887,730,573,414,255,96,-65,-224,-384,-543,-699,-855,-1009,-1160,-1310,-1454,
],dtype=float)

ia= np.array([
2132,2132,2132,1902,1674,1436,1202,958,714,475,222,-22,-264,-512,-756,-997,-1237,-1478,-1709,-1938,-2167,-2383,-2596,-2804,-3008,-3203,-3384,-3563,-3736,-3896,-4046,-4184,-4313,-4436,-4548,-4645,-4735,-4811,-4874,-4926,-4967,-4996,-5013,-5020,-5010,-4991,-4963,-4918,-4863,-4797,-4721,-4631,-4528,-4417,-4292,-4158,-4018,-3868,-3705,-3532,-3353,-3165,-2974,-2773,-2556,-2343,-2126,-1900,-1668,-1432,-1197,-953,-710,-468,-219,28,270,516,763,1003,1243,1482,1716,1940,2170,2394,2599,2810,3013,3205,3390,3564,3736,3897,4050,4189,4319,4444,4553,4653,4739,4816,4880,4933,4973,5000,5018,5023,5017,4997,4964,4926,4869,4802,4728,4636,4534,4423,4298,4165,4025,3873,3711,3542,3357,3169,2980,2775,2563,2349,2131,1904,1672,1440,1200,958,715,473,224,-23,-262,-509,-757,-995,-1237,-1480,-1709,-1936,-2164,-2385,-2598,-2802,-3007,-3202,-3385,-3565,-3737,-3897,-4046,-4185,-4315,-4436,-4549,-4646,-4733,-4810,-4872,-4927,-4968,-4994,-5013,-5016,-5012,-4993,-4958,-4919,-4865,-4797,-4720,-4630,-4529,-4415,-4291,-4159,-4016,-3864,-3704,-3531,-3350,-3165,-2973,-2767,-2554,-2345,-2124,-1895,-1666,-1432,-1195,-951,-709,-466,-218,29,272,516,764,1003,1242,1486,1719,1943,2172,2392,2605,2811,3013,3210,3390,3565,3737,3899,4049,4188,4321,4442,4554,4654,4740,4818,4881,4934,4973,5002,5021,5022,5019,4997,4966,4927,4869,4803,4726,4636,4534,4423,4298,4163,4024,3874,3709,3534,3357,3172,2977,2775,2563,2350,2131,1904,1671,1439,1202,957,715,473,222,-24,-263,-511,-757,-996,-1238,-1479,-1710,-1937,-2164,-2384,-2597,-2803,-3006,-3202,-3386,-3565,-3737,-3896,-4045,-4185,-4314,-4436,-4548,-4646,-4734,-4811,-4873,-4926,-4968,-4995,-5012,-5017,-5009,-4991,-4960,-4917,-4864,-4796,-4718,-4631,-4527,-4414,-4290,-4157,-4017,-3865,-3704,-3532,-3352,-3164,-2969,-2766,-2554,-2341,-2124,-1894,-1664,-1431,-1193,-951,-708,-465,-215,30,270,519,764,1005,1246,1485,1717,1945,2172,2391,2602,2813,3014,3208,3392,3566,3738,3901,4048,4189,4320,4442,4555,4653,4742,4818,4879,4933,4974,5002,5019,5024,5017,4999,4969,4925,4871,4805,4727,4638,4536,4422,4298,4164,4023,3874,3713,3536,3356,3172,2979,2775,2563,2351,2131,1901,1672,1441,1202,959,717,471,225,-21,-263,-508,-758,-995,-1237,-1480,-1710,-1936,-2162,-2384,-2597,-2803,-3006,-3201,-3384,-3563,-3735,-3897,-4045,-4182,-4314,-4435,-4545,-4646,-4734,-4811,-4873,-4925,-4968,-4995,-5012,-5018,-5010,-4991,-4961,-4918,-4865,-4798,-4719,-4630,-4527,-4415,-4291,-4157,-4018,-3866,-3704,-3531,-3350,-3166,-2975,-2767,-2553,-2344,-2126,-1894,-1667,-1434,-1194,-950,-708,-467,-218,27,270,519,762,1001,1246,1484,1712,1944,2172,2390,2603,2810,3013,3208,3389,3564,3736,3898,4047,4189,4321,4442,4554,4654,4740,4817,4882,4932,4973,5001,5019,5024,5017,4999,4965,4924,4872,4804,4725,4636,4537,4422,4299,4168,4022,3871,3712,3539,3357,3170,2980,2774,
],dtype=float)

vb= np.array([
3256,3256,3256,3251,3231,3189,3140,3099,3038,2972,2906,2822,2741,2649,2551,2450,2338,2227,2106,1982,1853,1717,1579,1434,1289,1142,989,837,681,524,365,206,46,-115,-274,-434,-593,-749,-904,-1057,-1208,-1355,-1499,-1640,-1777,-1910,-2036,-2158,-2277,-2389,-2495,-2595,-2689,-2778,-2858,-2932,-2999,-3058,-3110,-3155,-3192,-3222,-3244,-3256,-3263,-3262,-3251,-3233,-3207,-3174,-3134,-3084,-3029,-2966,-2895,-2818,-2734,-2642,-2546,-2444,-2334,-2220,-2099,-1974,-1844,-1710,-1572,-1430,-1284,-1134,-982,-828,-672,-515,-356,-197,-37,122,280,440,599,755,909,1063,1212,1360,1506,1646,1783,1915,2041,2163,2281,2395,2501,2602,2697,2784,2866,2939,3005,3066,3117,3162,3198,3227,3244,3249,3254,3258,3256,3251,3232,3189,3140,3099,3038,2972,2907,2823,2742,2651,2551,2451,2339,2227,2107,1981,1853,1717,1579,1435,1289,1142,991,838,682,524,365,206,46,-114,-274,-434,-592,-749,-904,-1058,-1208,-1355,-1499,-1640,-1778,-1909,-2037,-2160,-2277,-2390,-2494,-2596,-2691,-2777,-2859,-2933,-2999,-3059,-3111,-3155,-3192,-3222,-3243,-3258,-3263,-3261,-3252,-3233,-3208,-3174,-3133,-3085,-3028,-2965,-2895,-2817,-2734,-2643,-2544,-2443,-2334,-2218,-2099,-1972,-1843,-1710,-1571,-1429,-1283,-1133,-981,-827,-671,-513,-355,-196,-36,124,282,441,600,756,911,1064,1214,1361,1506,1648,1785,1916,2043,2165,2283,2396,2502,2603,2698,2785,2866,2940,3006,3066,3118,3162,3199,3227,3243,3249,3254,3258,3256,3251,3231,3188,3139,3099,3037,2971,2905,2821,2740,2649,2550,2449,2337,2226,2105,1980,1851,1715,1577,1433,1288,1140,989,836,680,522,363,204,45,-116,-276,-435,-594,-751,-906,-1059,-1210,-1357,-1501,-1642,-1779,-1911,-2038,-2160,-2278,-2390,-2496,-2597,-2691,-2778,-2859,-2933,-2999,-3059,-3111,-3155,-3193,-3222,-3243,-3258,-3263,-3260,-3251,-3233,-3207,-3174,-3133,-3085,-3028,-2965,-2895,-2817,-2733,-2641,-2544,-2442,-2333,-2219,-2098,-1973,-1843,-1709,-1571,-1429,-1282,-1133,-981,-826,-670,-513,-354,-196,-36,124,281,441,600,756,912,1063,1213,1362,1506,1648,1784,1916,2043,2165,2283,2395,2502,2603,2697,2785,2866,2940,3006,3065,3117,3162,3199,3227,3244,3249,3254,3258,3256,3251,3232,3189,3140,3099,3037,2972,2906,2821,2742,2649,2550,2450,2337,2226,2107,1981,1852,1716,1578,1434,1289,1142,990,838,681,524,365,205,46,-115,-275,-434,-593,-749,-905,-1058,-1208,-1356,-1499,-1640,-1777,-1909,-2037,-2160,-2277,-2389,-2495,-2595,-2690,-2778,-2858,-2932,-2999,-3058,-3111,-3155,-3192,-3222,-3242,-3257,-3264,-3260,-3251,-3233,-3207,-3174,-3133,-3086,-3029,-2966,-2896,-2818,-2734,-2644,-2546,-2443,-2335,-2219,-2099,-1974,-1843,-1710,-1573,-1429,-1284,-1134,-982,-828,-671,-515,-356,-197,-38,122,280,439,598,754,910,1062,1212,1360,1505,1647,1783,1915,2042,2164,2281,2394,2501,2602,2697,2784,2865,2939,3006,3065,3117,3162,3198,3227,3244,3249,
],dtype=float)

ib= np.array([
2870,2870,2870,3069,3258,3440,3615,3783,3940,4084,4220,4350,4468,4574,4669,4752,4824,4884,4932,4968,4994,5007,5007,4998,4971,4937,4893,4831,4760,4679,4587,4485,4371,4244,4107,3964,3810,3644,3467,3286,3100,2903,2698,2485,2272,2049,1819,1590,1355,1117,874,630,386,138,-106,-347,-594,-840,-1078,-1317,-1556,-1784,-2012,-2239,-2456,-2664,-2870,-3072,-3260,-3442,-3619,-3787,-3944,-4091,-4228,-4353,-4473,-4580,-4676,-4760,-4830,-4891,-4939,-4979,-5003,-5015,-5016,-5004,-4984,-4947,-4902,-4847,-4775,-4695,-4599,-4493,-4379,-4250,-4114,-3969,-3814,-3647,-3473,-3291,-3101,-2909,-2701,-2488,-2276,-2052,-1822,-1591,-1358,-1118,-873,-633,-389,-139,102,346,595,837,1077,1320,1554,1783,2012,2237,2454,2663,2870,3069,3259,3439,3615,3783,3938,4086,4222,4350,4469,4574,4670,4755,4825,4884,4935,4969,4995,5008,5009,5000,4976,4940,4893,4832,4761,4682,4590,4486,4371,4246,4110,3965,3811,3646,3471,3288,3100,2904,2697,2488,2272,2049,1823,1589,1356,1117,873,630,386,138,-106,-347,-595,-838,-1079,-1320,-1556,-1787,-2012,-2238,-2456,-2667,-2871,-3071,-3263,-3443,-3619,-3787,-3945,-4092,-4228,-4356,-4472,-4581,-4677,-4759,-4832,-4889,-4939,-4978,-5002,-5016,-5016,-5005,-4981,-4947,-4902,-4844,-4776,-4692,-4599,-4493,-4375,-4250,-4111,-3969,-3814,-3645,-3471,-3288,-3102,-2905,-2697,-2488,-2270,-2048,-1821,-1587,-1355,-1116,-871,-629,-386,-137,107,347,597,843,1080,1321,1558,1788,2013,2239,2458,2667,2873,3071,3261,3442,3617,3786,3941,4088,4225,4351,4470,4576,4670,4755,4826,4884,4933,4972,4996,5009,5008,4997,4976,4940,4892,4831,4760,4682,4588,4485,4371,4243,4108,3964,3809,3643,3469,3287,3098,2903,2696,2484,2271,2048,1818,1588,1356,1115,872,629,383,136,-106,-347,-595,-842,-1082,-1320,-1557,-1787,-2012,-2239,-2456,-2666,-2873,-3073,-3262,-3443,-3620,-3787,-3945,-4091,-4225,-4356,-4475,-4580,-4675,-4758,-4831,-4889,-4937,-4976,-5002,-5015,-5014,-5003,-4981,-4946,-4901,-4845,-4773,-4691,-4597,-4491,-4374,-4246,-4111,-3968,-3811,-3645,-3470,-3286,-3101,-2904,-2697,-2486,-2271,-2046,-1818,-1588,-1354,-1115,-870,-630,-385,-136,106,349,597,842,1081,1320,1559,1788,2013,2240,2457,2666,2873,3072,3262,3442,3618,3786,3942,4088,4225,4353,4472,4578,4671,4754,4826,4886,4934,4971,4997,5010,5011,5000,4976,4941,4893,4833,4764,4684,4590,4488,4372,4245,4112,3965,3812,3648,3472,3291,3102,2907,2700,2487,2275,2052,1821,1592,1357,1118,875,632,388,140,-104,-343,-593,-840,-1076,-1318,-1552,-1782,-2012,-2234,-2453,-2663,-2870,-3070,-3259,-3441,-3616,-3784,-3944,-4089,-4224,-4355,-4472,-4579,-4677,-4757,-4830,-4890,-4938,-4976,-5001,-5014,-5014,-5004,-4982,-4946,-4901,-4847,-4775,-4691,-4601,-4492,-4375,-4250,-4113,-3969,-3814,-3648,-3473,-3291,-3103,-2907,-2701,-2490,-2272,-2051,-1823,-1590,-1357,-1118,-874,-634,-387,-140,102,347,590,837,1079,1318,1555,1783,2012,2237,
],dtype=float)

vc= np.array([
-1384,-1384,-1384,-1239,-1088,-934,-780,-623,-464,-308,-148,12,172,333,491,649,806,957,1110,1262,1410,1553,1693,1827,1957,2082,2204,2321,2432,2537,2636,2727,2812,2891,2962,3026,3082,3132,3175,3209,3235,3247,3251,3257,3259,3256,3247,3220,3171,3127,3081,3015,2952,2879,2796,2712,2616,2518,2412,2300,2185,2063,1938,1807,1671,1529,1385,1237,1087,937,783,626,469,308,147,-13,-174,-331,-489,-649,-805,-959,-1112,-1261,-1406,-1551,-1690,-1826,-1956,-2082,-2203,-2316,-2426,-2531,-2629,-2723,-2808,-2887,-2961,-3024,-3082,-3133,-3174,-3210,-3236,-3255,-3266,-3270,-3266,-3252,-3232,-3206,-3168,-3125,-3074,-3015,-2949,-2876,-2797,-2710,-2618,-2517,-2411,-2303,-2184,-2063,-1937,-1803,-1669,-1528,-1385,-1238,-1087,-935,-780,-624,-466,-307,-148,11,172,332,491,649,803,957,1111,1261,1410,1554,1693,1827,1956,2083,2205,2321,2433,2537,2636,2728,2813,2892,2962,3026,3083,3132,3175,3209,3235,3247,3251,3257,3259,3256,3247,3219,3172,3127,3080,3014,2952,2879,2795,2711,2615,2517,2411,2300,2184,2063,1937,1806,1671,1527,1384,1236,1086,936,781,626,467,306,147,-14,-174,-332,-489,-650,-806,-960,-1114,-1262,-1407,-1552,-1691,-1826,-1957,-2083,-2203,-2318,-2426,-2532,-2630,-2723,-2809,-2887,-2960,-3026,-3083,-3133,-3175,-3210,-3236,-3255,-3267,-3270,-3265,-3254,-3232,-3205,-3169,-3125,-3073,-3016,-2948,-2875,-2798,-2709,-2617,-2518,-2411,-2302,-2183,-2063,-1936,-1802,-1669,-1527,-1385,-1238,-1086,-935,-778,-623,-465,-306,-148,13,172,332,492,649,805,958,1112,1262,1411,1554,1693,1828,1957,2083,2205,2322,2434,2538,2636,2728,2813,2891,2962,3026,3083,3133,3174,3209,3235,3246,3251,3257,3259,3256,3248,3220,3171,3126,3081,3014,2951,2879,2794,2712,2615,2517,2411,2299,2185,2060,1938,1805,1668,1529,1382,1236,1086,934,782,625,467,306,146,-14,-173,-332,-491,-649,-806,-960,-1113,-1262,-1408,-1552,-1690,-1827,-1957,-2082,-2203,-2316,-2428,-2532,-2630,-2724,-2808,-2889,-2961,-3024,-3084,-3133,-3176,-3210,-3236,-3255,-3266,-3270,-3265,-3253,-3233,-3204,-3169,-3125,-3074,-3015,-2948,-2876,-2796,-2710,-2617,-2517,-2412,-2301,-2185,-2063,-1935,-1804,-1669,-1529,-1385,-1238,-1088,-935,-780,-624,-465,-308,-148,12,172,333,492,648,804,958,1110,1262,1410,1553,1693,1827,1957,2082,2203,2321,2433,2537,2636,2728,2812,2891,2961,3025,3083,3132,3175,3208,3235,3247,3250,3257,3259,3256,3247,3220,3172,3127,3081,3014,2952,2879,2795,2713,2615,2518,2411,2300,2186,2062,1939,1806,1670,1530,1383,1237,1087,936,782,627,468,308,147,-14,-171,-331,-490,-647,-805,-960,-1112,-1261,-1407,-1551,-1690,-1826,-1957,-2082,-2202,-2316,-2426,-2532,-2630,-2723,-2809,-2887,-2961,-3025,-3083,-3133,-3175,-3210,-3235,-3256,-3266,-3270,-3267,-3253,-3233,-3205,-3169,-3125,-3074,-3015,-2949,-2876,-2796,-2710,-2617,-2516,-2412,-2302,-2184,-2064,-1936,-1804,
],dtype=float)

ic= np.array([
-5020,-5020,-5020,-4992,-4953,-4905,-4839,-4765,-4680,-4581,-4473,-4351,-4222,-4083,-3934,-3777,-3607,-3428,-3244,-3054,-2853,-2644,-2431,-2212,-1988,-1757,-1525,-1291,-1048,-806,-563,-315,-65,177,420,671,913,1152,1392,1627,1857,2082,2306,2520,2731,2936,3131,3321,3495,3671,3838,3987,4133,4265,4390,4506,4609,4698,4778,4848,4901,4948,4980,4998,5010,5008,4991,4963,4925,4876,4812,4738,4654,4556,4444,4327,4199,4056,3907,3750,3581,3403,3218,3026,2829,2618,2404,2189,1961,1731,1498,1258,1019,776,533,289,40,-201,-446,-695,-938,-1178,-1418,-1653,-1882,-2111,-2335,-2548,-2759,-2964,-3160,-3346,-3525,-3700,-3864,-4017,-4162,-4294,-4419,-4534,-4637,-4730,-4809,-4876,-4933,-4978,-5009,-5031,-5041,-5037,-5021,-4993,-4955,-4904,-4842,-4768,-4682,-4584,-4475,-4354,-4224,-4085,-3936,-3777,-3609,-3431,-3246,-3055,-2856,-2647,-2432,-2214,-1989,-1760,-1527,-1291,-1052,-806,-562,-316,-67,175,419,668,913,1151,1391,1624,1854,2082,2305,2522,2728,2933,3132,3317,3497,3670,3836,3989,4132,4266,4390,4505,4608,4701,4777,4845,4902,4945,4978,5000,5010,5005,4990,4963,4923,4874,4810,4737,4651,4556,4446,4324,4197,4055,3905,3749,3578,3401,3218,3024,2825,2617,2402,2185,1961,1730,1496,1257,1013,771,530,286,37,-206,-448,-697,-941,-1181,-1421,-1656,-1886,-2112,-2335,-2552,-2760,-2965,-3162,-3348,-3528,-3701,-3865,-4018,-4163,-4296,-4420,-4536,-4638,-4730,-4810,-4877,-4933,-4977,-5010,-5030,-5041,-5036,-5019,-4993,-4953,-4903,-4840,-4767,-4680,-4580,-4472,-4351,-4221,-4082,-3933,-3774,-3604,-3428,-3244,-3051,-2852,-2642,-2430,-2212,-1984,-1755,-1524,-1290,-1047,-803,-559,-311,-63,180,423,673,915,1153,1396,1629,1858,2087,2309,2523,2732,2936,3132,3321,3501,3673,3837,3990,4134,4268,4393,4508,4610,4701,4779,4846,4904,4948,4981,5002,5010,5007,4991,4964,4924,4873,4811,4739,4654,4555,4447,4327,4195,4056,3908,3749,3579,3402,3218,3027,2825,2616,2404,2186,1960,1730,1496,1257,1016,773,531,286,38,-204,-447,-697,-940,-1179,-1420,-1655,-1883,-2110,-2336,-2549,-2759,-2965,-3159,-3345,-3526,-3702,-3864,-4016,-4160,-4293,-4419,-4533,-4637,-4729,-4808,-4877,-4930,-4975,-5009,-5028,-5039,-5036,-5019,-4990,-4952,-4902,-4839,-4766,-4680,-4581,-4471,-4351,-4220,-4081,-3934,-3773,-3606,-3429,-3244,-3053,-2851,-2644,-2431,-2211,-1988,-1757,-1524,-1291,-1049,-804,-561,-312,-66,177,423,670,913,1155,1394,1628,1857,2083,2308,2522,2730,2937,3131,3319,3499,3671,3836,3990,4133,4267,4391,4506,4609,4701,4781,4846,4903,4948,4978,5001,5012,5007,4991,4964,4925,4875,4813,4739,4655,4556,4448,4327,4197,4059,3907,3751,3583,3402,3219,3028,2829,2620,2406,2187,1962,1733,1499,1260,1017,775,532,289,42,-202,-445,-694,-938,-1176,-1418,-1654,-1880,-2108,-2335,-2548,-2756,-2962,-3159,-3345,-3525,-3699,-3862,-4015,-4158,-4293,-4418,-4533,-4637,-4728,-4808,-4875,-4931,-4976,-5008,-5030,
],dtype=float)




a = 1/((burden*math.sqrt(2))/2500)
ifps = (PGA_GAIN_CURRENT*nominal_current)/a
print("ifps:",ifps)
a = 1/(R1+1)
vfps = nomial_voltage*a*math.sqrt(2)
print("vfps:",vfps)


ccc = nominal_current/(ifps*full_scale_Resample)
print("ccc:",ccc)
ccv = nomial_voltage/(vfps*full_scale_Resample)
print("ccv:",ccv)


va_rms = va*math.sqrt(2)*ccv
ia_rms = ia*math.sqrt(2)*ccc
vb_rms = vb*math.sqrt(2)*ccv
ib_rms = ib*math.sqrt(2)*ccc
vc_rms = vc*math.sqrt(2)*ccv
ic_rms = ic*math.sqrt(2)*ccc

va = np.max(va)*ccv
ia = np.max(ia)*ccc
vb = np.max(vb)*ccv
ib = np.max(ib)*ccc
vc = np.max(vc)*ccv
ic = np.max(ic)*ccc



plt.figure(figsize = (12, 6))
plt.subplot(121)
plt.title(r'Current ')
plt.plot(time,ia_rms, 'b',label = r'$i_{a}(t), i_{arms} = %.4f$'%(ia))
plt.plot(time,ib_rms, 'g',label = r'$i_{b}(t), i_{brms} = %.4f$'%(ib))
plt.plot(time,ic_rms, 'r',label = r'$i_{c}(t), i_{crms} = %.4f$'%(ic))
plt.xlabel('Time [s])')
plt.ylabel('Amplitude [A]')
plt.ticklabel_format(axis='both', style='sci',scilimits=(-3,3))
plt.tight_layout()
plt.legend(fancybox=True, framealpha=1, shadow=False, borderpad=1)

plt.subplot(122)
plt.title(r'Voltage')
plt.plot(time,va_rms, 'b',label = r'$v_{a}(t), v_{arms} = %.4f$'%(va))
plt.plot(time,vb_rms, 'g',label = r'$v_{b}(t), v_{brms} = %.4f$'%(vb))
plt.plot(time,vc_rms, 'r',label = r'$v_{c}(t), v_{crms} = %.4f$'%(vc))
plt.ticklabel_format(axis='x', style='sci',scilimits=(-3,-3))
plt.xlabel('Time [s]')
plt.ylabel('Amplitude [V]')
plt.tight_layout()
plt.legend(fancybox=True, framealpha=1, shadow=False, borderpad=1)


plt.savefig('graph.png')
plt.show()
